ACTOR TheCrucibleBase : BrutalWeapon {
    //$category Weapons
    obituary "%o was choped down by %k's Crucible."
    Inventory.PickupSound "AXEDRAW"
    Inventory.Pickupmessage "You got something that looks too big to be called a sword!"
    +WEAPON.NOAUTOAIM
    //+WEAPON.NOAUTOFIRE  // disable the alt fire
    //+FORCEXYBILLBOARD
    +WEAPON.NOALERT
    +WEAPON.AXEBLOOD
    +WEAPON.CHEATNOTWEAPON
    +WEAPON.AMMO_OPTIONAL
    
    DamageType Cut
    
    Tag "The Crucible"

    Weapon.SelectionOrder 20
    Weapon.SlotPriority 9999
    Weapon.SlotNumber 1
    Weapon.KickBack 100

    Scale 0.9

    States
    {
    Spawn:
        CRUC A 1
        CRUC A -1
        Stop

    Ready:
        TNT1 A 0
        CRST A 15
        TNT1 A 0 A_StartSound("crucible/raise", CHAN_AUTO)
        TNT1 A 0 A_Takeinventory("HasCutingWeapon",1)
        TNT1 A 0 A_TakeInventory("CrucibleAlt",1)
        CRST BCDEF 1
        TNT1 A 0 A_Quake(3, 5, 0, 32)
        Goto Ready2
    
    Ready2:
    Ready3:
        //CRID ABCDEFGHIJKLMNOPQRS 1 A_WeaponReady
        CRID A 2 A_WeaponReady
        TNT1 A 0 A_StartSound("crucible/idle", CHAN_AUTO)
        TNT1 A 0 A_TakeInventory("CrucibleAlt",1)

        TNT1 A 0 A_Giveinventory("HasCutingWeapon",1)
        TNT1 A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        TNT1 A 0 A_JumpIfInventory("Taunting",1,"Taunt")
        TNT1 A 0 A_JumpIfInventory("Salute1", 1, "Salute")
        TNT1 A 0 A_JumpIfInventory("Salute2", 1, "Salute")
        TNT1 A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
        
        loop

    Deselect:
        TNT1 A 0 A_TakeInventory("CrucibleAlt",1)
        TNT1 A 0 A_StartSound("crucible/down", CHAN_AUTO)
        CRST FEDCB 1
        Goto Deselect2

    Deselect2:
        CRST A 1 A_Lower
        loop

    Select:
        TNT1 A 0
        TNT1 A 0 A_Giveinventory("GoSpecial",1)
        TNT1 A 0 A_Takeinventory("FistsSelected",1)
        TNT1 A 0 A_Takeinventory("SawSelected",1)
        TNT1 A 0 A_Takeinventory("ShotgunSelected",1)
        TNT1 A 0 A_Takeinventory("SSGSelected",1)
        TNT1 A 0 A_Takeinventory("MinigunSelected",1)
        TNT1 A 0 A_Takeinventory("PlasmaGunSelected",1)
        TNT1 A 0 A_Takeinventory("RocketLauncherSelected",1)
        TNT1 A 0 A_Takeinventory("GrenadeLauncherSelected",1)
        TNT1 A 0 A_Takeinventory("BFGSelected",1)
        TNT1 A 0 A_Takeinventory("BFG10kSelected",1)
        TNT1 A 0 A_Takeinventory("RailGunSelected",1)
        TNT1 A 0 A_Takeinventory("SubMachineGunSelected",1)
        TNT1 A 0 A_Takeinventory("RevenantLauncherSelected",1)
        TNT1 A 0 A_Takeinventory("LostSoulSelected",1)
        TNT1 A 0 A_Takeinventory("FlameCannonSelected",1)
        TNT1 A 0 A_Takeinventory("HasBarrel",1)
        CRST A 1 A_Raise
        loop

    Fire:
        CRAT A 1
        CRA2 A 1
        CRA2 B 5
        CRA2 C 1
        TNT1 A 0 A_Giveinventory("HasCutingWeapon",1)
        TNT1 A 0 A_StartSound("weapons/gswing", CHAN_AUTO)
        //TNT1 A 0 A_StartSound("crucible/fire", CHAN_AUTO)
        CRAT B 1
        TNT1 A 0 A_GunFlash
        TNT1 A 0 A_AlertMonsters(200)

        // fullsound, hitsound, damage, pufftype, flags, range, spread_xy, spread_z, lifesteal
        //TNT1 A 0 A_Saw("", "", 10, "AxePuffs", SF_NOPULLIN  | SF_NOTURN | SF_NORANDOM, 50, 0, 0)

        CRAT G 1 A_FireProjectile("CrucibleAttack", 0, 0, 0, 0, 0, 0)
        //TNT1 A 0 A_Quake(5, 20, 0, 32)
        CRAT HIJ 2
        CRAT K 6
        TNT1 A 0 A_TakeInventory("SwordStrikes",1)
        CRAT A 1 A_ReFire
        Goto Ready2
        
    AltFire:
        TNT1 A 0 A_JumpIfInventory("CrucibleAlt",1,"AltFire2")
        CRBL AB 1
        Goto AltFire2
        
    AltFire2:
        TNT1 A 0 A_GiveInventory("CrucibleAlt",1)
        TNT1 A 0 A_StartSound("crucible/idle", CHAN_AUTO)
        TNT1 A 0 A_GiveInventory("CrucibleBlock",1)
        CRBL CDED 3
        Goto Ready2

    Flash:
        CRST G 0 Bright A_Light2
        Stop
    }
}

ACTOR TheCrucible : TheCrucibleBase replaces Crucible {
    States {
        Fire:
            CRAT A 1
            CRA2 A 1
            CRA2 B 1
            CRA2 C 1
            TNT1 A 0 A_Giveinventory("HasCutingWeapon",1)
            //TNT1 A 0 A_StartSound("weapons/gswing", CHAN_AUTO)
            //TNT1 A 0 A_StartSound("crucible/fire", CHAN_AUTO)
            CRAT B 1
            TNT1 A 0 A_GunFlash
            TNT1 A 0 A_AlertMonsters(200)
            
            CRAT G 1 A_FireProjectile("CrucibleAttack", 0, 0, 0, 0, 0, 0)
            
            //TNT1 A 0 A_Quake(5, 20, 0, 32)
            CRAT HIJ 1
            CRAT K 1
            TNT1 A 0 A_TakeInventory("SwordStrikes",1)
            CRAT A 0 A_ReFire
            Goto Ready2
    }
}

Actor CrucibleAttack {
    Projectile
    Radius 10
    Height 2
    DamageType Cut
    +MISSILE
    +FORCEXYBILLBOARD
    +FORCERADIUSDMG
    //+BLOODSPLATTER
    +EXTREMEDEATH
    +FORCEPAIN
    RenderStyle Add
    Alpha 0.6
    Damage 0
    Speed 0
    SeeSound "none"
    DeathSound "none"
    decal "none"
    Scale 1

    States {
        Spawn:
        XDeath:
        Melee:
        Crash:
        Death:
            TNT1 A 1
            TNT1 A 1 A_Explode(random(100, 200), 60, 0, false, 60)
            Stop
    }
}

Actor CrucibleAttackTest : CrucibleAttack {
    Radius 10
    Speed 0
    Scale 1
    Damage 1
    
    States {
        Spawn:
        XDeath:
        Melee:
        Crash:
        Death:
            TNT1 A 0
            TNT1 A 1 A_Print("CrucibleAttack::Death")
            Goto Super::Death
    }
}

ACTOR TheDoomSlayer : Doomer
{
	Speed 1.0
    Health 200
	Player.DisplayName "The Doom Slayer"
	Player.StartItem "TheCrucible"
	Player.StartItem "Rifle"
	Player.StartItem "Melee_Attacks"
	Player.StartItem "IsPlayer", 1
	Player.StartItem "Clip2", 30
	Player.StartItem "RifleAmmo", 31
	Player.StartItem "BDPistolAmmo", 16
	Player.StartItem "BDDualPistolAmmo", 16
	Player.StartItem "DoubleRifleAmmo", 31
	Player.StartItem "ShotgunAmmo", 10
	Player.StartItem "PlasmaAmmo", 50
	Player.StartItem "DoublePlasmaAmmo", 50
	Player.StartItem "AssaultShotgunAmmo", 20
	Player.StartItem "BDSMGAmmo", 41
	Player.StartItem "SSGAmmo", 2
	Player.StartItem "RocketRounds", 6
	Player.StartItem "RailgunAmmo", 50
	Player.StartItem "IsPlayer", 1
	Player.StartItem "HandGrenades", 1
	Player.StartItem "GrenadeAmmo", 2
	Player.StartItem "NeverSelectedShotgun", 1
	Player.StartItem "IsNOTTacticalClass", 1
	Player.StartItem "AmmoDroper"
	Species "Marines"

    +FRIGHTENING
}
